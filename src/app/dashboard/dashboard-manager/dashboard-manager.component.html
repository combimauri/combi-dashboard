<div class="content">
  <nz-page-header class="page-header" nzBackIcon [nzGhost]="false">
    <nz-page-header-title>
      <nz-select
        class="select"
        nzPlaceHolder="Choose Dashboard"
        [nzLoading]="loadingDashboards"
        [(ngModel)]="selectedDashboardId"
      >
        <nz-option-group nzLabel="Dashboards">
          <ng-container *ngFor="let item of dashboardList$ | async">
            <nz-option [nzValue]="item.id" [nzLabel]="item.name"></nz-option>
          </ng-container>
        </nz-option-group>
      </nz-select>
    </nz-page-header-title>
    <nz-page-header-extra>
      <button nz-button nzType="primary" (click)="isWidgetsModalVisible = true">
        Add Widget
      </button>
    </nz-page-header-extra>
  </nz-page-header>
  <div class="inner-content main-content grid-content">
    <gridster [options]="gridOptions">
      <nz-list-empty *ngIf="isDashboardEmpty"></nz-list-empty>
      <ng-container #dashboardContainer></ng-container>
    </gridster>
  </div>
</div>

<nz-modal
  nzTitle="Widgets"
  [nzFooter]="null"
  (nzOnCancel)="dismissAddWidget()"
  [(nzVisible)]="isWidgetsModalVisible"
>
  <ng-container *nzModalContent>
    <nz-list [nzLoading]="loadingWidgets">
      <ng-container *ngIf="widgetList$ | async as widgetList">
        <nz-list-item *ngFor="let item of widgetList">
          <nz-list-item-meta
            [nzAvatar]="widgetIcon"
            [nzDescription]="item.description"
          >
            <nz-list-item-meta-title>
              <a [routerLink]="['/widgets', item.id]">{{ item.name }}</a>
            </nz-list-item-meta-title>
          </nz-list-item-meta>
          <ul nz-list-item-actions>
            <nz-list-item-action>
              <a (click)="addWidget(item)">add</a>
            </nz-list-item-action>
          </ul>
        </nz-list-item>
        <nz-list-empty *ngIf="widgetList.length === 0"></nz-list-empty>
      </ng-container>
    </nz-list>
  </ng-container>
</nz-modal>

<ng-template #widgetIcon>
  <nz-avatar [nzSize]="44" nzIcon="pie-chart"></nz-avatar>
</ng-template>
